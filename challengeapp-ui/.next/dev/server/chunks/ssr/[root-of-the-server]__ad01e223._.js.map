{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/framos/ChallengeApp/challengeapp-ui/src/pages/dashboard.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useRouter } from \"next/router\";\r\nimport UploadModal from \"../components/UploadModal\";\r\n\r\ntype DocumentDto = {\r\n  id: number;\r\n  name: string;\r\n  type: string;\r\n  uploadedAt: string;\r\n};\r\n\r\ntype PagedResponse = {\r\n  items: DocumentDto[];\r\n  totalPages: number;\r\n};\r\n\r\nexport default function DashboardPage() {\r\n  const [documents, setDocuments] = useState<DocumentDto[]>([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(1);\r\n  const [error, setError] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  const router = useRouter();\r\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n\r\n  const fetchDocuments = async () => {\r\n    if (!token) {\r\n      router.push(\"/\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const url = `${process.env.NEXT_PUBLIC_API_URL}/documents`;\r\n      console.log(\"üì° Fetching documents from:\", url);\r\n\r\n      const response = await axios.get<PagedResponse>(url, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        params: { search, page }\r\n      });\r\n\r\n      console.log(\"üì¶ Response data:\", response.data);\r\n\r\n      const { items, totalPages } = response.data || {};\r\n      setDocuments(Array.isArray(items) ? items : []);\r\n      setTotalPages(totalPages || 1);\r\n      setError(\"\");\r\n    } catch (err: any) {\r\n      console.error(\"‚ùå Failed to load documents:\", err.response?.status, err.response?.data || err.message);\r\n      setError(\"Failed to load documents.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDocuments();\r\n  }, [search, page]);\r\n\r\n  return (\r\n    <div style={{ maxWidth: 800, margin: \"auto\", paddingTop: \"2rem\" }}>\r\n      <h2>Documents</h2>\r\n\r\n      <button onClick={() => setShowModal(true)} style={{ marginBottom: \"1rem\" }}>\r\n        Upload new document\r\n      </button>\r\n\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Search by name or type\"\r\n        value={search}\r\n        onChange={e => setSearch(e.target.value)}\r\n        style={{ width: \"100%\", marginBottom: \"1rem\", padding: \"0.5rem\" }}\r\n      />\r\n\r\n      {loading ? (\r\n        <p>Loading...</p>\r\n      ) : error ? (\r\n        <p style={{ color: \"red\" }}>{error}</p>\r\n      ) : (\r\n        <table style={{ width: \"100%\", borderCollapse: \"collapse\", border: \"1px solid #ccc\" }}>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ borderBottom: \"1px solid #ccc\", textAlign: \"left\", padding: \"0.5rem\" }}>Name</th>\r\n              <th style={{ borderBottom: \"1px solid #ccc\", textAlign: \"left\", padding: \"0.5rem\" }}>Type</th>\r\n              <th style={{ borderBottom: \"1px solid #ccc\", textAlign: \"left\", padding: \"0.5rem\" }}>Date</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {documents.length > 0 ? (\r\n              documents.map(doc => (\r\n                <tr key={doc.id}>\r\n                  <td style={{ padding: \"0.5rem\" }}>{doc.name}</td>\r\n                  <td style={{ padding: \"0.5rem\" }}>{doc.type}</td>\r\n                  <td style={{ padding: \"0.5rem\" }}>{new Date(doc.uploadedAt).toLocaleDateString()}</td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td colSpan={3} style={{ padding: \"0.5rem\", textAlign: \"center\" }}>\r\n                  No documents available.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n\r\n      <div style={{ marginTop: \"1rem\", display: \"flex\", justifyContent: \"center\", gap: \"1rem\" }}>\r\n        <button onClick={() => setPage(p => Math.max(p - 1, 1))} disabled={page === 1}>\r\n          ‚Üê Previous\r\n        </button>\r\n        <span>Page {page} of {totalPages}</span>\r\n        <button onClick={() => setPage(p => Math.min(p + 1, totalPages))} disabled={page === totalPages}>\r\n          Next ‚Üí\r\n        </button>\r\n      </div>\r\n\r\n      {showModal && token && (\r\n        <UploadModal\r\n          token={token}\r\n          onClose={() => setShowModal(false)}\r\n          onSuccess={fetchDocuments}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}