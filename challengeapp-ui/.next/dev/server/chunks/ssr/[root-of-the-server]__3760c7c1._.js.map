{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/framos/ChallengeApp/challengeapp-ui/src/pages/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport axios from \"axios\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\ntype LoginResponse = {\r\n  token: string;\r\n  user: {\r\n    email: string;\r\n    role: string;\r\n  };\r\n};\r\n\r\nexport default function LoginPage() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) return;\r\n\r\n    try {\r\n      const decoded = jwtDecode<{ exp?: number }>(token);\r\n      if (!decoded.exp || Date.now() < decoded.exp * 1000) {\r\n        router.push(\"/dashboard\");\r\n      }\r\n    } catch {}\r\n  }, []);\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      const response = await axios.post<LoginResponse>(\r\n        `${process.env.NEXT_PUBLIC_API_URL}/auth/login`,\r\n        { email, password }\r\n      );\r\n\r\n      const { token, user } = response.data;\r\n      localStorage.setItem(\"token\", token);\r\n      localStorage.setItem(\"userEmail\", user.email);\r\n      localStorage.setItem(\"userRole\", user.role);\r\n\r\n      console.log(\"✅ Login successful for:\", user.email);\r\n      router.push(\"/dashboard\");\r\n    } catch (err) {\r\n      console.error(\"❌ Login failed:\", err);\r\n      setError(\"Invalid credentials or connection error.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ maxWidth: 400, margin: \"auto\", paddingTop: \"5rem\" }}>\r\n      <h2>ChallengeApp Login</h2>\r\n      <input\r\n        type=\"email\"\r\n        placeholder=\"Email\"\r\n        value={email}\r\n        onChange={(e) => setEmail(e.target.value)}\r\n        style={{ display: \"block\", marginBottom: \"1rem\", width: \"100%\" }}\r\n      />\r\n      <input\r\n        type=\"password\"\r\n        placeholder=\"Password\"\r\n        value={password}\r\n        onChange={(e) => setPassword(e.target.value)}\r\n        style={{ display: \"block\", marginBottom: \"1rem\", width: \"100%\" }}\r\n      />\r\n      <button onClick={handleLogin} style={{ width: \"100%\" }}>\r\n        Sign in\r\n      </button>\r\n      {error && <p style={{ color: \"red\", marginTop: \"1rem\" }}>{error}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;;;;;AAUe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IACzC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,SAAS,IAAA,oIAAS;IAExB,IAAA,gHAAS,EAAC;QACR,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,CAAC,OAAO;QAEZ,IAAI;YACF,MAAM,UAAU,IAAA,uIAAS,EAAmB;YAC5C,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,GAAG,KAAK,QAAQ,GAAG,GAAG,MAAM;gBACnD,OAAO,IAAI,CAAC;YACd;QACF,EAAE,OAAM,CAAC;IACX,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI;YACF,MAAM,WAAW,MAAM,qHAAK,CAAC,IAAI,CAC/B,oEAAmC,WAAW,CAAC,EAC/C;gBAAE;gBAAO;YAAS;YAGpB,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,SAAS,IAAI;YACrC,aAAa,OAAO,CAAC,SAAS;YAC9B,aAAa,OAAO,CAAC,aAAa,KAAK,KAAK;YAC5C,aAAa,OAAO,CAAC,YAAY,KAAK,IAAI;YAE1C,QAAQ,GAAG,CAAC,2BAA2B,KAAK,KAAK;YACjD,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,mBAAmB;YACjC,SAAS;QACX;IACF;IAEA,qBACE,qKAAC;QAAI,OAAO;YAAE,UAAU;YAAK,QAAQ;YAAQ,YAAY;QAAO;;0BAC9D,qKAAC;0BAAG;;;;;;0BACJ,qKAAC;gBACC,MAAK;gBACL,aAAY;gBACZ,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,OAAO;oBAAE,SAAS;oBAAS,cAAc;oBAAQ,OAAO;gBAAO;;;;;;0BAEjE,qKAAC;gBACC,MAAK;gBACL,aAAY;gBACZ,OAAO;gBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;gBAC3C,OAAO;oBAAE,SAAS;oBAAS,cAAc;oBAAQ,OAAO;gBAAO;;;;;;0BAEjE,qKAAC;gBAAO,SAAS;gBAAa,OAAO;oBAAE,OAAO;gBAAO;0BAAG;;;;;;YAGvD,uBAAS,qKAAC;gBAAE,OAAO;oBAAE,OAAO;oBAAO,WAAW;gBAAO;0BAAI;;;;;;;;;;;;AAGhE","debugId":null}}]
}